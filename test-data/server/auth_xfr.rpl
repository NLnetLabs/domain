; Based on https://github.com/NLnetLabs/unbound/blob/172b84f7ce6507e96fe51bd94448222a5a47274b/testdata/auth_xfr.rpl

; config options
server:
    provide-xfr: 127.0.0.1 NOKEY
	local-data: "example.com.	3600	IN	SOA	ns.example.com. hostmaster.example.com. 1 3600 900 86400 3600"
	local-data: "example.com.	3600	IN	NS	ns.example.net."
	local-data: "www.example.com.	3600	IN	A	1.2.3.4"

CONFIG_END

SCENARIO_BEGIN Test AXFR out

; Retrieve the zone via AXFR from the server
STEP 10 QUERY
ENTRY_BEGIN
MATCH TCP
SECTION QUESTION
	example.com. IN AXFR
ENTRY_END

STEP 20 CHECK_ANSWER
ENTRY_BEGIN
MATCH all
REPLY QR AA NOERROR
SECTION QUESTION
	example.com. IN AXFR
SECTION ANSWER
	example.com.	3600	IN	SOA	ns.example.com. hostmaster.example.com. 1 3600 900 86400 3600
	example.com.	3600	IN	NS	ns.example.net.
	www.example.com.	3600	IN	A	1.2.3.4
	example.com.	3600	IN	SOA	ns.example.com. hostmaster.example.com. 1 3600 900 86400 3600
ENTRY_END

SCENARIO_END